<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="/lib/pace/pace-theme-minimal.min.css">
  <script src="/lib/pace/pace.min.js"></script>

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"kcmetercec.top","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":"flat"},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":true,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="kernel version arch    v5.4.0 arm32   复习网站： 鸟哥私房菜 重温文件系统(ext)的相关操作并做整理，不然我这尿记性要不了多久又会忘。。。">
<meta property="og:type" content="article">
<meta property="og:title" content="Linux文件系统结构概览">
<meta property="og:url" content="http://kcmetercec.top/2024/09/08/linux_fs_overview/index.html">
<meta property="og:site_name" content="explorer">
<meta property="og:description" content="kernel version arch    v5.4.0 arm32   复习网站： 鸟哥私房菜 重温文件系统(ext)的相关操作并做整理，不然我这尿记性要不了多久又会忘。。。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://github.com/KcMeterCEC/explore/blob/master/%5BLinux%5D/%5Bfs%5D/%5BWhat%5DLinux--fs_basic/vfs_overview.jpg?raw=true">
<meta property="og:image" content="https://github.com/KcMeterCEC/explore/blob/master/%5BLinux%5D/%5Bfs%5D/%5BWhat%5DLinux--fs_basic/vfs_fileoperations.jpg?raw=true">
<meta property="og:image" content="https://github.com/KcMeterCEC/explore/blob/master/%5BLinux%5D/%5Bfs%5D/%5BWhat%5DLinux--fs_basic/fs_struct_overview.jpg?raw=true">
<meta property="og:image" content="https://github.com/KcMeterCEC/explore/blob/master/%5BLinux%5D/%5Bfs%5D/%5BWhat%5DLinux--fs_basic/inode_block_overview.jpg?raw=true">
<meta property="og:image" content="https://github.com/KcMeterCEC/explore/blob/master/%5BLinux%5D/%5Bfs%5D/%5BWhat%5DLinux--fs_basic/inode_save_block.jpg?raw=true">
<meta property="og:image" content="https://github.com/KcMeterCEC/explore/blob/master/%5BLinux%5D/%5Bfs%5D/%5BWhat%5DLinux--fs_basic/dir2file.jpg?raw=true">
<meta property="og:image" content="https://github.com/KcMeterCEC/explore/blob/master/%5BLinux%5D/%5Bfs%5D/%5BWhat%5DLinux--fs_basic/soft_link_overview.jpg?raw=true">
<meta property="og:image" content="https://github.com/KcMeterCEC/explore/blob/master/%5BLinux%5D/%5Bfs%5D/%5BWhat%5DLinux--fs_basic/hard_link_overview.jpg?raw=true">
<meta property="article:published_time" content="2024-09-07T16:00:00.000Z">
<meta property="article:modified_time" content="2024-09-07T16:00:00.000Z">
<meta property="article:author" content="kcmetercec">
<meta property="article:tag" content="linux">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://github.com/KcMeterCEC/explore/blob/master/%5BLinux%5D/%5Bfs%5D/%5BWhat%5DLinux--fs_basic/vfs_overview.jpg?raw=true">

<link rel="canonical" href="http://kcmetercec.top/2024/09/08/linux_fs_overview/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>Linux文件系统结构概览 | explorer</title>
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-112423075-1# <app_id>"></script>
    <script data-pjax>
      if (CONFIG.hostname === location.hostname) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-112423075-1# <app_id>');
      }
    </script>






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="explorer" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">explorer</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">万丈高楼平地起，勿在浮沙筑高台</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
        <li class="menu-item menu-item-sitemap">

    <a href="/sitemap.xml" rel="section"><i class="fa fa-sitemap fa-fw"></i>站点地图</a>

  </li>
        <li class="menu-item menu-item-commonweal">

    <a href="/404/" rel="section"><i class="fa fa-heartbeat fa-fw"></i>公益 404</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://kcmetercec.top/2024/09/08/linux_fs_overview/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://avatars.githubusercontent.com/u/16881795?s=400&u=f62971f44f59d17d823044e709d4668debec7c02&v=4">
      <meta itemprop="name" content="kcmetercec">
      <meta itemprop="description" content="Qt, C++, linux, CS">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="explorer">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Linux文件系统结构概览
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2024-09-08 00:00:00" itemprop="dateCreated datePublished" datetime="2024-09-08T00:00:00+08:00">2024-09-08</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/linux/" itemprop="url" rel="index"><span itemprop="name">linux</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/linux/fs/" itemprop="url" rel="index"><span itemprop="name">fs</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/linux/fs/overview/" itemprop="url" rel="index"><span itemprop="name">overview</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span><br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>4k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>4 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <table>
<thead>
<tr>
<th>kernel version</th>
<th>arch</th>
</tr>
</thead>
<tbody><tr>
<td>v5.4.0</td>
<td>arm32</td>
</tr>
</tbody></table>
<p>复习网站： <a target="_blank" rel="noopener" href="http://linux.vbird.org/linux_basic/0230filesystem.php#">鸟哥私房菜</a></p>
<p>重温文件系统(ext)的相关操作并做整理，不然我这尿记性要不了多久又会忘。。。</p>
<span id="more"></span>

<h1 id="文件系统的组成"><a href="#文件系统的组成" class="headerlink" title="文件系统的组成"></a>文件系统的组成</h1><h2 id="概览"><a href="#概览" class="headerlink" title="概览"></a>概览</h2><p>在Linux中，一个磁盘可以分为多个区，每个区可以格式化为不同的文件系统，<br>最终通过虚拟文件系统VFS将这些抽象给上层统一的函数接口操作。</p>
<p><img src="https://github.com/KcMeterCEC/explore/blob/master/%5BLinux%5D/%5Bfs%5D/%5BWhat%5DLinux--fs_basic/vfs_overview.jpg?raw=true"></p>
<ul>
<li>在驱动中，无论是字符设备、块设备、还是其他文件系统，与VFS所接口的都是填充 <code>struct file_operations</code> 结构体</li>
</ul>
<p><img src="https://github.com/KcMeterCEC/explore/blob/master/%5BLinux%5D/%5Bfs%5D/%5BWhat%5DLinux--fs_basic/vfs_fileoperations.jpg?raw=true"><br>一个ext文件系统的组成部分如下图：</p>
<p><img src="https://github.com/KcMeterCEC/explore/blob/master/%5BLinux%5D/%5Bfs%5D/%5BWhat%5DLinux--fs_basic/fs_struct_overview.jpg?raw=true"></p>
<h3 id="Boot-Sector"><a href="#Boot-Sector" class="headerlink" title="Boot Sector"></a>Boot Sector</h3><p>此部分通过MBR跳转过来，用于显示关于此部分系统的启动界面以及引导系统启动，以达到多重启动的目的。 <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Boot_sector">wiki上有很详细的解释</a></p>
<h3 id="Block-Group"><a href="#Block-Group" class="headerlink" title="Block Group"></a>Block Group</h3><p>Block Group 用于将文件系统分为几个块，便于管理。</p>
<h3 id="Superblock"><a href="#Superblock" class="headerlink" title="Superblock"></a>Superblock</h3><p>此部分描述整个文件系统信息，是此分区文件系统的全部概览。 </p>
<p><strong>一个文件系统只能有一个Superblock,其他BlockGroup中可能会具有Superblock的备份，用于备用恢复。</strong></p>
<h3 id="文件系统描述"><a href="#文件系统描述" class="headerlink" title="文件系统描述"></a>文件系统描述</h3><p>此部分是描述当前block group的相关信息。</p>
<h3 id="区块对照表-block-bitmap"><a href="#区块对照表-block-bitmap" class="headerlink" title="区块对照表(block bitmap)"></a>区块对照表(block bitmap)</h3><p>此表用于查询文件系统中的block的使用情况，以反应出block的全局概览。</p>
<h3 id="inode对照表-inode-bitmap"><a href="#inode对照表-inode-bitmap" class="headerlink" title="inode对照表(inode bitmap)"></a>inode对照表(inode bitmap)</h3><p>此表用于查询文件系统中的inode的使用情况，以反应出inode的全局概览。</p>
<h3 id="inode-table"><a href="#inode-table" class="headerlink" title="inode table"></a>inode table</h3><p>用于存储该部分的inode的具体内容，一个文件对应一个inode。</p>
<p>inode用于描述文件权限、群组关系、容量、时间、链接的block等等相关信息，它不包含文件的实际内容。</p>
<p>inode中存储了包含文件内容的block索引，系统可以根据此索引预读文件内容，如下图：</p>
<p><img src="https://github.com/KcMeterCEC/explore/blob/master/%5BLinux%5D/%5Bfs%5D/%5BWhat%5DLinux--fs_basic/inode_block_overview.jpg?raw=true"><br>一个inode的大小是有限制的，如果一个文件很大，就会需要很多的block。<br>那么一个inode就无法存储这么多地址，所以文件系统使用一部分block来存储inode，如下图：</p>
<p><img src="https://github.com/KcMeterCEC/explore/blob/master/%5BLinux%5D/%5Bfs%5D/%5BWhat%5DLinux--fs_basic/inode_save_block.jpg?raw=true"><br>ext2/3 的inode可以直接寻址的block为12个，间接寻址、双间接寻址、三间接寻址各一个。</p>
<ul>
<li>一个block的地址为4字节，当block为4k时那么它就可以存储1024个block地址</li>
<li>所以一个直接寻址的总共block大小为 <code>12 * 4k = 48k (block_size * num)</code></li>
<li>间接寻址 :<code>1024 * 4k = 4M  [(block_size / 4) ^ 1] * block_size</code></li>
<li>双间接寻址: <code>1024 * 1024 * 4k = 4GB  [(block_size / 4) ^ 2] * block_size</code></li>
<li>三间接寻址为: <code>1024 * 1024 * 1024 * 4k = 4TB [(block_size / 4) ^ 3] * block_size</code></li>
</ul>
<p>ext4在此基础上做了优化:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">本来的ext2/3中inode以1个4字节对应一个block，如果一个文件占用了1000个block，</span><br><span class="line">那对应的inode中需要分配block来对应存储这1000个block的索引。</span><br><span class="line"></span><br><span class="line">但如果这1000个block地址是连续的，那就没有必要一一存储，可以在inode中存储一个结构体</span><br><span class="line">以表示block索引的起始地址和结束地址。这样就大大减少了inode的存储空间。</span><br><span class="line"></span><br><span class="line">也就是说同样大小的文件，ext4中对应inode此文件的inode占用空间更小，</span><br><span class="line">那么ext4中的inode能表示的文件大小范围也更大。</span><br></pre></td></tr></table></figure>

<h3 id="data-block"><a href="#data-block" class="headerlink" title="data block"></a>data block</h3><p>data block 用于存储文件的实际内容，在格式化的时候一个block的大小就规定好了，此为最小的存储单位。<br>也就是说当一个文件内容不足一个block也会占用一个block。</p>
<h2 id="superblock-查看与理解"><a href="#superblock-查看与理解" class="headerlink" title="superblock 查看与理解"></a>superblock 查看与理解</h2><ul>
<li>首先使用命令 <code>sudo blkid</code> 查看当前已经被格式化过的且已挂载的分区以及对应的文件系统</li>
<li>然后使用命令 <code>sudo dumpe2fs -h &lt;partition&gt;</code> 用于查看文件系统的全局概览。<ul>
<li>当不加 h 选项时还会输出 block group 的信息。<br>通过下面这个输出就可以看出一个 superblock 中可以看到的文件系统信息：</li>
</ul>
</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">文件系统名称</span></span><br><span class="line">Filesystem volume name:   &lt;none&gt;</span><br><span class="line"><span class="meta">#</span><span class="bash">上一次的挂载点</span></span><br><span class="line">Last mounted on:          /</span><br><span class="line">Filesystem UUID:          db4b4bdb-ebff-4928-b154-786622f8438f</span><br><span class="line">Filesystem magic number:  0xEF53</span><br><span class="line">Filesystem revision #:    1 (dynamic)</span><br><span class="line"><span class="meta">#</span><span class="bash">文件系统特征</span></span><br><span class="line">Filesystem features:      has_journal ext_attr resize_inode dir_index filetype needs_recovery extent flex_bg sparse_super large_file huge_file uninit_bg dir_nlink extra_isize</span><br><span class="line">Filesystem flags:         signed_directory_hash</span><br><span class="line"><span class="meta">#</span><span class="bash">默认挂载选项</span></span><br><span class="line">Default mount options:    user_xattr acl</span><br><span class="line"><span class="meta">#</span><span class="bash">文件系统状态</span></span><br><span class="line">Filesystem state:         clean</span><br><span class="line">Errors behavior:          Continue</span><br><span class="line">Filesystem OS type:       Linux</span><br><span class="line"><span class="meta">#</span><span class="bash">总共的inode数量</span></span><br><span class="line">Inode count:              8126464</span><br><span class="line"><span class="meta">#</span><span class="bash">总共的block数量</span></span><br><span class="line">Block count:              32505600</span><br><span class="line"><span class="meta">#</span><span class="bash">保留的block数量</span></span><br><span class="line">Reserved block count:     1625280</span><br><span class="line"><span class="meta">#</span><span class="bash">还剩余多少blocks和inodes可用</span></span><br><span class="line">Free blocks:              28442724</span><br><span class="line">Free inodes:              7560146</span><br><span class="line"><span class="meta">#</span><span class="bash">第一个block的起始索引</span></span><br><span class="line">First block:              0</span><br><span class="line"><span class="meta">#</span><span class="bash">block 大小</span></span><br><span class="line">Block size:               4096</span><br><span class="line">Fragment size:            4096</span><br><span class="line">Reserved GDT blocks:      1016</span><br><span class="line"><span class="meta">#</span><span class="bash">每个group的block数量</span></span><br><span class="line">Blocks per group:         32768</span><br><span class="line">Fragments per group:      32768</span><br><span class="line"><span class="meta">#</span><span class="bash">每个group的inode数量</span></span><br><span class="line">Inodes per group:         8192</span><br><span class="line"><span class="meta">#</span><span class="bash">每个group可用多少个block来表示inode</span></span><br><span class="line">Inode blocks per group:   512</span><br><span class="line">Flex block group size:    16</span><br><span class="line"><span class="meta">#</span><span class="bash">时间信息</span></span><br><span class="line">Filesystem created:       Tue Apr 18 22:27:06 2017</span><br><span class="line">Last mount time:          Thu Apr 26 09:20:42 2018</span><br><span class="line">Last write time:          Thu Apr 26 09:20:38 2018</span><br><span class="line">Mount count:              280</span><br><span class="line">Maximum mount count:      -1</span><br><span class="line">Last checked:             Tue Apr 18 22:27:06 2017</span><br><span class="line">Check interval:           0 (&lt;none&gt;)</span><br><span class="line">Lifetime writes:          137 GB</span><br><span class="line">Reserved blocks uid:      0 (user root)</span><br><span class="line">Reserved blocks gid:      0 (group root)</span><br><span class="line">First inode:              11</span><br><span class="line"><span class="meta">#</span><span class="bash">inode大小</span></span><br><span class="line">Inode size:               256</span><br><span class="line">Required extra isize:     28</span><br><span class="line">Desired extra isize:      28</span><br><span class="line"><span class="meta">#</span><span class="bash">日志系统的inode号码</span></span><br><span class="line">Journal inode:            8</span><br><span class="line">First orphan inode:       3538974</span><br><span class="line">Default directory hash:   half_md4</span><br><span class="line">Directory Hash Seed:      7deaec65-123c-4de8-aab7-9ca8dd458823</span><br><span class="line">Journal backup:           inode blocks</span><br><span class="line">Journal features:         journal_incompat_revoke</span><br><span class="line"><span class="meta">#</span><span class="bash">文件日志可用大小</span></span><br><span class="line">Journal size:             128M</span><br><span class="line">Journal length:           32768</span><br><span class="line">Journal sequence:         0x00042c45</span><br><span class="line">Journal start:            16552</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">第一个group的block索引范围</span></span><br><span class="line">Group 0: (Blocks 0-32767) [ITABLE_ZEROED]</span><br><span class="line">  Checksum 0x5c5a, unused inodes 8175</span><br><span class="line"><span class="meta">  #</span><span class="bash">主superblock在0号block里面，group描述符在1-8号block里面</span></span><br><span class="line">  Primary superblock at 0, Group descriptors at 1-8</span><br><span class="line">  Reserved GDT blocks at 9-1024</span><br><span class="line"><span class="meta">  #</span><span class="bash">block位图地址与inode位图地址</span></span><br><span class="line">  Block bitmap at 1025 (+1025), Inode bitmap at 1041 (+1041)</span><br><span class="line"><span class="meta">  #</span><span class="bash">Inode Table地址</span></span><br><span class="line">  Inode table at 1057-1568 (+1057)</span><br><span class="line"><span class="meta">  #</span><span class="bash">剩余可用inode和block</span></span><br><span class="line">  22550 free blocks, 8176 free inodes, 2 directories, 8175 unused inodes</span><br><span class="line"><span class="meta">  #</span><span class="bash">具体剩余索引</span></span><br><span class="line">  Free blocks: 9255-9309, 9366-9402, 10310-32767</span><br><span class="line">  Free inodes: 16, 18-8192</span><br></pre></td></tr></table></figure>

<p>上面信息中说每个group有8192个inode可用，其 计算公式为：</p>
<ul>
<li>Inode Table 占用的block数量为 <code>1568 - 1057 + 1 = 512</code></li>
<li>由于一个block大小为4096字节，所以inode table 总共占用 <code>512 * 4096 = 2097152</code> 字节</li>
<li>由于一个inode的大小为256字节，所以一个inode table可用容纳 <code>2097152 / 256 = 8192</code> 个inode</li>
</ul>
<p>根据文件系统的结构来看，可以知道新增一个档案的流程为：</p>
<ol>
<li>确定使用者是否有 wx 权限，有权限才能新增</li>
<li>从inode bitmap 中取出一个空闲的inode号码 ,并将权限写入此inode</li>
<li>从block bitmap 中根据文件大小取出对应个数的block并将文件内容写入block</li>
<li>将文件对应的block号码写入其对应的inode,如果block太多还需要申请更多的block来存储inode</li>
<li>将新写入的inode和block同步到inode bitmap,block bitmap, superblock 中</li>
</ol>
<p>对应的删除一个档案的流程为：</p>
<ol>
<li>确定使用者具有wx权限</li>
<li>将对应的block 和 inode 置为空闲并同步到 inode bitmap , block bitmap ,superblock 中<ul>
<li>这里仅仅是猜测文件系统为了效率是不会实际删除内容的，而是清除其标志即可。待后面分析其代码再回头来梳理</li>
</ul>
</li>
</ol>
<h2 id="目录与文件的关系"><a href="#目录与文件的关系" class="headerlink" title="目录与文件的关系"></a>目录与文件的关系</h2><p>通过inode与block的关系可以知道目录肯定有其自己的inode与block，其block链接至其他的文件，如下图：</p>
<p><img src="https://github.com/KcMeterCEC/explore/blob/master/%5BLinux%5D/%5Bfs%5D/%5BWhat%5DLinux--fs_basic/dir2file.jpg?raw=true"></p>
<ul>
<li>使用命令 <code>ls -li</code> 可以列出当前目录下存储文档的inode </li>
</ul>
<p>需要注意的是：inode并不保存文件名，文件名是保存在目录的block中的， <strong>所以文件的读取都是要先经过目录的</strong></p>
<p>其流程为：</p>
<ol>
<li>根据文件系统挂载点得知起始目录的inode</li>
<li>读取目录inode权限确认可以访问对应block中的内容</li>
<li>读取目录block中的内容，并根据文件名匹配到对应的inode</li>
<li>根据文件的inode进行权限确认是否可以访问文件block</li>
<li>读取block中的内容…</li>
</ol>
<h2 id="日志档案系统的作用"><a href="#日志档案系统的作用" class="headerlink" title="日志档案系统的作用"></a>日志档案系统的作用</h2><p>当在文件的增删过程中如果出现意外(比如文件内容已经写入但是inode bitmap, block bitmap, superblock没有得到同步)，<br>这就会出现内容与描述不一致的情况，系统为了还原此描述就需要扫描整个文件系统内容来同步修复，这个效率显然是很低下的。</p>
<p>日志文件系统就是记录文件的修改过程，当出现不一致时系统直接来比对日志即可，这样效率就提高了不少。</p>
<h2 id="VFS"><a href="#VFS" class="headerlink" title="VFS"></a>VFS</h2><ul>
<li>通过命令 <code>ls -al /lib/modules/$(uname -r)/kernel/fs</code> 可以看到系统所支持的文件系统种类</li>
<li>通过命令 <code>cat /proc/filesystems</code> 可以查看已经载入到RAM中的文件系统</li>
</ul>
<h1 id="文件系统的操作"><a href="#文件系统的操作" class="headerlink" title="文件系统的操作"></a>文件系统的操作</h1><h2 id="查看目录与硬盘容量"><a href="#查看目录与硬盘容量" class="headerlink" title="查看目录与硬盘容量"></a>查看目录与硬盘容量</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">列出当前系统已经挂载的文件系统，显示其使用率，挂载点等信息</span></span><br><span class="line"><span class="meta">#</span><span class="bash">当只是简单查看时，可以不用加 <span class="string">&#x27;a&#x27;</span> 选项</span></span><br><span class="line">df -aTh</span><br><span class="line"><span class="meta">#</span><span class="bash">显示当前系统中已挂载文件系统inode的使用率</span></span><br><span class="line">df -ih</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">列出当前目录及其子目录占用总容量</span></span><br><span class="line">du -sh</span><br></pre></td></tr></table></figure>

<h2 id="软链接与硬链接"><a href="#软链接与硬链接" class="headerlink" title="软链接与硬链接"></a>软链接与硬链接</h2><h3 id="软链接"><a href="#软链接" class="headerlink" title="软链接"></a>软链接</h3><p>软链接：新建一个文件，此文件的内容(block)指向的是被链接的文件名(由被链接文件的目录inode间接找到此文件名)</p>
<ul>
<li>使用 <code>ln -s &lt;src&gt; &lt;dst&gt;</code> 建立软链接</li>
<li>通过 <code>df -i</code> 可以看到 inode数量变化，以及通过 <code>ll -i</code> 可以看到新建文件指向的inode不一致</li>
</ul>
<p><img src="https://github.com/KcMeterCEC/explore/blob/master/%5BLinux%5D/%5Bfs%5D/%5BWhat%5DLinux--fs_basic/soft_link_overview.jpg?raw=true"><br>软链接优点：</p>
<ol>
<li>可以跨文件系统</li>
<li>可以链接目录<ul>
<li>对链接目录的软链接文件使用 <code>rm -rf soft_link_file</code> <strong>并不会删除对应目录，而仅仅是删除此软链接文件</strong></li>
</ul>
</li>
</ol>
<p>软链接缺点：</p>
<ol>
<li>会新建一个文件从而占用一个 inode和block</li>
<li>被链接的文件在其目录被删除后，无法通过链接文件访问文件内容</li>
</ol>
<h3 id="硬链接"><a href="#硬链接" class="headerlink" title="硬链接"></a>硬链接</h3><p>硬链接：在目录的内容(block)中新建立一个指向被链接文件名的inode的映射关系</p>
<ul>
<li>使用 <code>ln &lt;src&gt; &lt;dst&gt;</code> 建立硬链接</li>
<li>通过 <code>df -i</code> 可以看到 inode数量不变，以及通过 <code>ll -i</code> 可以看到新建文件指向的inode一致,此时inode被链接数也会增加</li>
<li>新建的目录默认链接数是2(包括 “dir” 和 “dir/.”)而上层目录的链接数会加1(因为 “dir/..”) 会指向此目录</li>
</ul>
<p><img src="https://github.com/KcMeterCEC/explore/blob/master/%5BLinux%5D/%5Bfs%5D/%5BWhat%5DLinux--fs_basic/hard_link_overview.jpg?raw=true"><br>硬链接的优点：</p>
<ol>
<li>仅仅是在目录block中建立映射关系，所以不会消耗更多的inode和block<ul>
<li>除非目录block已经满了，则还需要新增加一个block来存储</li>
</ul>
</li>
<li>当被链接文件在其目录中的对应关系被删除后，在当前文件依然可以访问文件内容</li>
</ol>
<p>硬链接的缺点：</p>
<ol>
<li>不能跨文件系统</li>
<li>不能链接目录</li>
</ol>
<h2 id="分区、格式化、挂载"><a href="#分区、格式化、挂载" class="headerlink" title="分区、格式化、挂载"></a>分区、格式化、挂载</h2><h3 id="查看磁盘分区状态"><a href="#查看磁盘分区状态" class="headerlink" title="查看磁盘分区状态"></a>查看磁盘分区状态</h3><ul>
<li>使用命令 <code>lsblk</code> 可以查看当前系统磁盘以及其分区状态<ul>
<li>使用 <code>-f</code> 选项可以查看对应的UUID</li>
</ul>
</li>
<li>使用命令 <code>parted /dev/xxx print</code> 查看某个磁盘具体分区情况<ul>
<li>其中 <code>Partiton Table</code> 指出了磁盘使用的分割表</li>
</ul>
</li>
</ul>
<h3 id="磁盘分割"><a href="#磁盘分割" class="headerlink" title="磁盘分割"></a>磁盘分割</h3><ul>
<li>使用 <code>fdisk /dev/xxx</code> 对使用MBR分割表的磁盘进行分割</li>
<li>使用 <code>gdisk /dev/xxx</code> 对使用GPT分割表的磁盘进行分割</li>
<li>分割完成后，使用 <code>partprobe -s</code> 来更新分区表</li>
</ul>
<p>嵌入式批量出厂时， 可以在 <code>sed</code> 的帮助下完成自动化的分割，来源于 <a target="_blank" rel="noopener" href="https://superuser.com/questions/332252/how-to-create-and-format-a-partition-using-a-bash-script">[wiki上有很详细的解释]</a></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> to create the partitions programatically (rather than manually)</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> we<span class="string">&#x27;re going to simulate the manual input to fdisk</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="string"> The sed script strips off all the comments so that we can</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="string"> document what we&#x27;</span>re doing in-line with the actual commands</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Note that a blank line (commented as <span class="string">&quot;default&quot;</span> will send a empty</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> line terminated with a newline to take the fdisk default.</span></span><br><span class="line">sed -e &#x27;s/\s*\([\+0-9a-zA-Z]*\).*/\1/&#x27; &lt;&lt; EOF | fdisk $&#123;TGTDEV&#125;</span><br><span class="line">  o # clear the in memory partition table</span><br><span class="line">  n # new partition</span><br><span class="line">  p # primary partition</span><br><span class="line">  1 # partition number 1</span><br><span class="line"><span class="meta">  #</span><span class="bash"> default - start at beginning of disk</span></span><br><span class="line">  +100M # 100 MB boot parttion</span><br><span class="line">  n # new partition</span><br><span class="line">  p # primary partition</span><br><span class="line">  2 # partion number 2</span><br><span class="line"><span class="meta">  #</span><span class="bash"> default, start immediately after preceding partition</span></span><br><span class="line"><span class="meta">  #</span><span class="bash"> default, extend partition to end of disk</span></span><br><span class="line">  a # make a partition bootable</span><br><span class="line">  1 # bootable partition is partition 1 -- /dev/sda1</span><br><span class="line">  p # print the in-memory partition table</span><br><span class="line">  w # write the partition table</span><br><span class="line">  q # and we&#x27;re done</span><br><span class="line">  EOF</span><br></pre></td></tr></table></figure>

<h3 id="磁盘格式化"><a href="#磁盘格式化" class="headerlink" title="磁盘格式化"></a>磁盘格式化</h3><ul>
<li>使用命令 <code>mkfs.ext4 /dev/xxxn</code> 来格式化对应分区</li>
</ul>
<h3 id="文件系统的检验"><a href="#文件系统的检验" class="headerlink" title="文件系统的检验"></a>文件系统的检验</h3><ul>
<li>使用命令 <code>fsck.ext4</code> 可以完成ext4 文件系统的检查</li>
</ul>
<h3 id="挂载与卸载"><a href="#挂载与卸载" class="headerlink" title="挂载与卸载"></a>挂载与卸载</h3><p>在挂载前需要注意的是：</p>
<ol>
<li><p>单一目录不应该重复挂载多个文件系统</p>
</li>
<li><p>要作为挂载点的目录需要是空目录</p>
</li>
</ol>
<ul>
<li><p>首先使用 <code>mkdir &lt;new dir&gt;</code> 新建空目录</p>
</li>
<li><p>然后使用 <code>mount /dev/xxxn &lt;new dir&gt;</code> 将分区挂载到空目录上</p>
</li>
<li><p>使用 <code>unmount &lt;dir&gt;</code> 来卸载分区</p>
</li>
</ul>
<h3 id="开机挂载"><a href="#开机挂载" class="headerlink" title="开机挂载"></a>开机挂载</h3><p>开机挂载规则存储于文件 <code>/etc/fstab</code> 中，如果需要增加挂载规则，那么在后面继续加入即可。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> /etc/fstab: static file system information.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="bash"><span class="comment"># Use &#x27;blkid&#x27; to print the universally unique identifier for a</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> device; this may be used with UUID= as a more robust way to name devices</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> that works even <span class="keyword">if</span> disks are added and removed. See fstab(5).</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="bash"><span class="comment"># &lt;file system&gt; &lt;mount point&gt;   &lt;type&gt;  &lt;options&gt;       &lt;dump&gt;  &lt;pass&gt;</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> / was on /dev/sda1 during installation</span></span><br><span class="line">UUID=db4b4bdb-ebff-4928-b154-786622f8438f /               ext4    errors=remount-ro 0       1</span><br><span class="line"><span class="meta">#</span><span class="bash"> swap was on /dev/sda5 during installation</span></span><br><span class="line">UUID=25fea792-68fb-4dcc-a793-c96933dd39a1 none            swap    sw              0       0</span><br></pre></td></tr></table></figure>

<p>其规则从左到右依次为：</p>
<ul>
<li>UUID : 分区的唯一ID</li>
<li>mount point: 挂载的目录路径</li>
<li>type : 文件系统类型</li>
<li>options : 文件系统参数</li>
</ul>
<table>
<thead>
<tr>
<th>参数</th>
<th>意义</th>
</tr>
</thead>
<tbody><tr>
<td>async/sync</td>
<td>是否以同步方式操作，一般为async</td>
</tr>
<tr>
<td>auto/noauto</td>
<td>当使用 mount -a 时，此文件系统是否会被主动测试挂载，默认为auto</td>
</tr>
<tr>
<td>rw/ro</td>
<td>整个文件系统的读写权限</td>
</tr>
<tr>
<td>exec/noexec</td>
<td>此文件系统中的档案是否可执行</td>
</tr>
<tr>
<td>user/nouser</td>
<td>是否允许普通用户可以挂载该文件系统，默认为nouser(不允许)</td>
</tr>
<tr>
<td>suid/nosuid</td>
<td>文件系统中的文件是否允许SUID的存在</td>
</tr>
<tr>
<td>default</td>
<td>默认:rw,suid,dev,exec,auto,nouser,async, 所以一般使用此参数即可</td>
</tr>
</tbody></table>
<ul>
<li>dump : 是否能被 dump 备份指定使用，一般设为 0</li>
<li>pass : 是否在开机是进行文件系统检查，为1代表需要检查 </li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">当 fstab 文件写入有误导致开机失败，那么可以进入维护模式然后使用命令  &quot;mount -n -o remount,rw /&quot;</span><br></pre></td></tr></table></figure>
    </div>

    
    
    
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>kcmetercec
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="http://kcmetercec.top/2024/09/08/linux_fs_overview/" title="Linux文件系统结构概览">http://kcmetercec.top/2024/09/08/linux_fs_overview/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/linux/" rel="tag"> <i class="fa fa-tag"></i> linux</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2024/09/02/linux_process_create/" rel="prev" title="Linux下进程的创建">
      <i class="fa fa-chevron-left"></i> Linux下进程的创建
    </a></div>
      <div class="post-nav-item">
    <a href="/2024/09/10/linux_fs_hello/" rel="next" title="Linux文件系统基本操作">
      Linux文件系统基本操作 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="gitalk-container"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E7%9A%84%E7%BB%84%E6%88%90"><span class="nav-number">1.</span> <span class="nav-text">文件系统的组成</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%A6%82%E8%A7%88"><span class="nav-number">1.1.</span> <span class="nav-text">概览</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Boot-Sector"><span class="nav-number">1.1.1.</span> <span class="nav-text">Boot Sector</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Block-Group"><span class="nav-number">1.1.2.</span> <span class="nav-text">Block Group</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Superblock"><span class="nav-number">1.1.3.</span> <span class="nav-text">Superblock</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E6%8F%8F%E8%BF%B0"><span class="nav-number">1.1.4.</span> <span class="nav-text">文件系统描述</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8C%BA%E5%9D%97%E5%AF%B9%E7%85%A7%E8%A1%A8-block-bitmap"><span class="nav-number">1.1.5.</span> <span class="nav-text">区块对照表(block bitmap)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#inode%E5%AF%B9%E7%85%A7%E8%A1%A8-inode-bitmap"><span class="nav-number">1.1.6.</span> <span class="nav-text">inode对照表(inode bitmap)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#inode-table"><span class="nav-number">1.1.7.</span> <span class="nav-text">inode table</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#data-block"><span class="nav-number">1.1.8.</span> <span class="nav-text">data block</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#superblock-%E6%9F%A5%E7%9C%8B%E4%B8%8E%E7%90%86%E8%A7%A3"><span class="nav-number">1.2.</span> <span class="nav-text">superblock 查看与理解</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%9B%AE%E5%BD%95%E4%B8%8E%E6%96%87%E4%BB%B6%E7%9A%84%E5%85%B3%E7%B3%BB"><span class="nav-number">1.3.</span> <span class="nav-text">目录与文件的关系</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%97%A5%E5%BF%97%E6%A1%A3%E6%A1%88%E7%B3%BB%E7%BB%9F%E7%9A%84%E4%BD%9C%E7%94%A8"><span class="nav-number">1.4.</span> <span class="nav-text">日志档案系统的作用</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#VFS"><span class="nav-number">1.5.</span> <span class="nav-text">VFS</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E7%9A%84%E6%93%8D%E4%BD%9C"><span class="nav-number">2.</span> <span class="nav-text">文件系统的操作</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8B%E7%9B%AE%E5%BD%95%E4%B8%8E%E7%A1%AC%E7%9B%98%E5%AE%B9%E9%87%8F"><span class="nav-number">2.1.</span> <span class="nav-text">查看目录与硬盘容量</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%BD%AF%E9%93%BE%E6%8E%A5%E4%B8%8E%E7%A1%AC%E9%93%BE%E6%8E%A5"><span class="nav-number">2.2.</span> <span class="nav-text">软链接与硬链接</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BD%AF%E9%93%BE%E6%8E%A5"><span class="nav-number">2.2.1.</span> <span class="nav-text">软链接</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A1%AC%E9%93%BE%E6%8E%A5"><span class="nav-number">2.2.2.</span> <span class="nav-text">硬链接</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%86%E5%8C%BA%E3%80%81%E6%A0%BC%E5%BC%8F%E5%8C%96%E3%80%81%E6%8C%82%E8%BD%BD"><span class="nav-number">2.3.</span> <span class="nav-text">分区、格式化、挂载</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8B%E7%A3%81%E7%9B%98%E5%88%86%E5%8C%BA%E7%8A%B6%E6%80%81"><span class="nav-number">2.3.1.</span> <span class="nav-text">查看磁盘分区状态</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A3%81%E7%9B%98%E5%88%86%E5%89%B2"><span class="nav-number">2.3.2.</span> <span class="nav-text">磁盘分割</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A3%81%E7%9B%98%E6%A0%BC%E5%BC%8F%E5%8C%96"><span class="nav-number">2.3.3.</span> <span class="nav-text">磁盘格式化</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E7%9A%84%E6%A3%80%E9%AA%8C"><span class="nav-number">2.3.4.</span> <span class="nav-text">文件系统的检验</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8C%82%E8%BD%BD%E4%B8%8E%E5%8D%B8%E8%BD%BD"><span class="nav-number">2.3.5.</span> <span class="nav-text">挂载与卸载</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BC%80%E6%9C%BA%E6%8C%82%E8%BD%BD"><span class="nav-number">2.3.6.</span> <span class="nav-text">开机挂载</span></a></li></ol></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="kcmetercec"
      src="https://avatars.githubusercontent.com/u/16881795?s=400&u=f62971f44f59d17d823044e709d4668debec7c02&v=4">
  <p class="site-author-name" itemprop="name">kcmetercec</p>
  <div class="site-description" itemprop="description">Qt, C++, linux, CS</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">107</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">55</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">13</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/KcMeterCEC" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;KcMeterCEC" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:kcmeter.cec@gmail.com" title="E-Mail → mailto:kcmeter.cec@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="/atom.xml" title="RSS → &#x2F;atom.xml"><i class="fa fa-rss fa-fw"></i>RSS</a>
      </span>
  </div>
  <div class="cc-license motion-element" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2021 – 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">kcmetercec</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
      <span class="post-meta-item-text">站点总字数：</span>
    <span title="站点总字数">206k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span class="post-meta-item-text">站点阅读时长 &asymp;</span>
    <span title="站点阅读时长">3:08</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div>

        
<div class="busuanzi-count">
  <script data-pjax async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/pjax/pjax.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/medium-zoom@1/dist/medium-zoom.min.js"></script>

<script src="/js/utils.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>

  <script>
var pjax = new Pjax({
  selectors: [
    'head title',
    '#page-configurations',
    '.content-wrap',
    '.post-toc-wrap',
    '.languages',
    '#pjax'
  ],
  switches: {
    '.post-toc-wrap': Pjax.switches.innerHTML
  },
  analytics: false,
  cacheBust: false,
  scrollTo : !CONFIG.bookmark.enable
});

window.addEventListener('pjax:success', () => {
  document.querySelectorAll('script[data-pjax], script#page-configurations, #pjax script').forEach(element => {
    var code = element.text || element.textContent || element.innerHTML || '';
    var parent = element.parentNode;
    parent.removeChild(element);
    var script = document.createElement('script');
    if (element.id) {
      script.id = element.id;
    }
    if (element.className) {
      script.className = element.className;
    }
    if (element.type) {
      script.type = element.type;
    }
    if (element.src) {
      script.src = element.src;
      // Force synchronous loading of peripheral JS.
      script.async = false;
    }
    if (element.dataset.pjax !== undefined) {
      script.dataset.pjax = '';
    }
    if (code !== '') {
      script.appendChild(document.createTextNode(code));
    }
    parent.appendChild(script);
  });
  NexT.boot.refresh();
  // Define Motion Sequence & Bootstrap Motion.
  if (CONFIG.motion.enable) {
    NexT.motion.integrator
      .init()
      .add(NexT.motion.middleWares.subMenu)
      .add(NexT.motion.middleWares.postList)
      .bootstrap();
  }
  NexT.utils.updateSidebarPosition();
});
</script>




  




  
<script src="/js/local-search.js"></script>









<script data-pjax>
document.querySelectorAll('.pdfobject-container').forEach(element => {
  let url = element.dataset.target;
  let pdfOpenParams = {
    navpanes : 0,
    toolbar  : 0,
    statusbar: 0,
    pagemode : 'thumbs',
    view     : 'FitH'
  };
  let pdfOpenFragment = '#' + Object.entries(pdfOpenParams).map(([key, value]) => `${key}=${encodeURIComponent(value)}`).join('&');
  let fullURL = `/lib/pdf/web/viewer.html?file=${encodeURIComponent(url)}${pdfOpenFragment}`;

  if (NexT.utils.supportsPDFs()) {
    element.innerHTML = `<embed class="pdfobject" src="${url + pdfOpenFragment}" type="application/pdf" style="height: ${element.dataset.height};">`;
  } else {
    element.innerHTML = `<iframe src="${fullURL}" style="height: ${element.dataset.height};" frameborder="0"></iframe>`;
  }
});
</script>




    <div id="pjax">
  

  

<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.css">

<script>
NexT.utils.loadComments(document.querySelector('#gitalk-container'), () => {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js', () => {
    var gitalk = new Gitalk({
      clientID    : 'f938893867df78f94802',
      clientSecret: 'b6d8470939c53d26c98c4e3b9d4c9ceb55d6e78e',
      repo        : 'kcmetercec.github.io',
      owner       : 'KcMeterCEC',
      admin       : ['KcMeterCEC'],
      id          : '4b0d4554921397b05743b12e62344913',
        language: 'zh-CN',
      distractionFreeMode: false
    });
    gitalk.render('gitalk-container');
  }, window.Gitalk);
});
</script>

    </div>
</body>
</html>
